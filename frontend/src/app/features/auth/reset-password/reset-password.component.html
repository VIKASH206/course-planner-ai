<div class="auth-container">
  <!-- Success State -->
  <div *ngIf="resetSuccess()" class="success-container">
    <div class="success-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9 12l2 2 4-4"></path>
      </svg>
    </div>
    <h1 class="success-title">Password Reset Successfully!</h1>
    <p class="success-message">Your password has been updated. You can now login with your new password.</p>
    <button class="submit-button" [routerLink]="['/auth/login']">
      Back to Login
    </button>
  </div>

  <!-- Invalid Token State -->
  <div *ngIf="!tokenValid() && !resetSuccess()" class="error-container">
    <div class="error-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    </div>
    <h1 class="error-title">Invalid Reset Link</h1>
    <p class="error-message">This password reset link is invalid or has expired. Please request a new one.</p>
    <button class="submit-button" [routerLink]="['/auth/forgot-password']">
      Request New Link
    </button>
  </div>

  <!-- Reset Password Form -->
  <div *ngIf="tokenValid() && !resetSuccess()" class="reset-password-box">
    <div class="lock-icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        <circle cx="12" cy="16" r="1"></circle>
      </svg>
    </div>

    <h1 class="reset-password-title">Reset Your Password</h1>
    <p class="reset-password-subtitle">Enter your new password below</p>

    <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">
      <!-- New Password Field -->
      <div class="form-group">
        <label class="form-label">New Password <span class="required">*</span></label>
        <div class="input-wrapper">
          <span class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
          </span>
          <input
            [type]="hidePassword() ? 'password' : 'text'"
            formControlName="password"
            placeholder="Enter new password"
            class="form-input"
            autocomplete="new-password"
          />
          <button
            type="button"
            class="visibility-toggle"
            (click)="togglePasswordVisibility()"
          >
            <svg *ngIf="hidePassword()" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
            <svg *ngIf="!hidePassword()" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </button>
        </div>
        <span class="error-message" *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">
          {{ getPasswordError() }}
        </span>
      </div>

      <!-- Confirm Password Field -->
      <div class="form-group">
        <label class="form-label">Confirm Password <span class="required">*</span></label>
        <div class="input-wrapper">
          <span class="input-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
          </span>
          <input
            [type]="hideConfirmPassword() ? 'password' : 'text'"
            formControlName="confirmPassword"
            placeholder="Re-enter password"
            class="form-input"
            autocomplete="new-password"
          />
          <button
            type="button"
            class="visibility-toggle"
            (click)="toggleConfirmPasswordVisibility()"
          >
            <svg *ngIf="hideConfirmPassword()" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
            <svg *ngIf="!hideConfirmPassword()" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </button>
        </div>
        <span class="error-message" *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">
          {{ getConfirmPasswordError() }}
        </span>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="submit-button"
        [disabled]="isLoading()"
        [class.loading]="isLoading()"
      >
        <span *ngIf="isLoading()" class="spinner"></span>
        <span *ngIf="!isLoading()">RESET PASSWORD</span>
      </button>
    </form>

    <div class="back-link">
      <a [routerLink]="['/auth/login']" class="text-link">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Back to Login
      </a>
    </div>
  </div>
</div>
